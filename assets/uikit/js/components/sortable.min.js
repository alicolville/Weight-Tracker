/*! ykukUIkit 3.9.4 | https://www.getuikit.com | (c) 2014 - 2022 YOOtheme | MIT License */(function(e,g){typeof exports=="object"&&typeof module!="undefined"?module.exports=g(require("uikit-util")):typeof define=="function"&&define.amd?define("uikitsortable",["uikit-util"],g):(e=typeof globalThis!="undefined"?globalThis:e||self,e.ykukUIkitSortable=g(e.ykukUIkit.util))})(this,function(e){"use strict";function g(r){return D(r,"top","bottom")}function D(r,n,o){for(var s=[[]],h=0;h<r.length;h++){var a=r[h];if(!!e.isVisible(a))for(var t=u(a),f=s.length-1;f>=0;f--){var c=s[f];if(!c[0]){c.push(a);break}var d=void 0;if(c[0].offsetParent===a.offsetParent?d=u(c[0]):(t=u(a,!0),d=u(c[0],!0)),t[n]>=d[o]-1&&t[n]!==d[n]){s.push([a]);break}if(t[o]-1>d[n]||t[n]===d[n]){c.push(a);break}if(f===0){s.unshift([a]);break}}}return s}function u(r,n){var o;n===void 0&&(n=!1);var s=r.offsetTop,h=r.offsetLeft,a=r.offsetHeight,t=r.offsetWidth;return n&&(o=e.offsetPosition(r),s=o[0],h=o[1]),{top:s,left:h,bottom:s+a,right:h+t}}var b="ykuk-transition-leave",w="ykuk-transition-enter";function y(r,n,o,s){s===void 0&&(s=0);var h=l(n,!0),a={opacity:1},t={opacity:0},f=function(i){return function(){return h===l(n)?i():e.Promise.reject()}},c=f(function(){return e.addClass(n,b),e.Promise.all(C(n).map(function(i,p){return new e.Promise(function(v){return setTimeout(function(){return e.Transition.start(i,t,o/2,"ease").then(v)},p*s)})})).then(function(){return e.removeClass(n,b)})}),d=f(function(){var i=e.height(n);return e.addClass(n,w),r(),e.css(e.children(n),{opacity:0}),new e.Promise(function(p){return requestAnimationFrame(function(){var v=e.children(n),m=e.height(n);e.css(n,"alignContent","flex-start"),e.height(n,i);var L=C(n);e.css(v,t);var B=L.map(function(O,_){return new e.Promise(function(Y){return setTimeout(function(){return e.Transition.start(O,a,o/2,"ease").then(Y)},_*s)})});i!==m&&B.push(e.Transition.start(n,{height:m},o/2+L.length*s,"ease")),e.Promise.all(B).then(function(){e.removeClass(n,w),h===l(n)&&(e.css(n,{height:"",alignContent:""}),e.css(v,{opacity:""}),delete n.dataset.transition),p()})})})});return e.hasClass(n,b)?T(n).then(d):e.hasClass(n,w)?T(n).then(c).then(d):c().then(d)}function l(r,n){return n&&(r.dataset.transition=1+l(r)),e.toNumber(r.dataset.transition)||0}function T(r){return e.Promise.all(e.children(r).filter(e.Transition.inProgress).map(function(n){return new e.Promise(function(o){return e.once(n,"transitionend transitioncanceled",o)})}))}function C(r){return g(e.children(r)).reduce(function(n,o){return n.concat(e.sortBy(o.filter(function(s){return e.isInView(s)}),"offsetLeft"))},[])}function F(r,n,o){return new e.Promise(function(s){return requestAnimationFrame(function(){var h=e.children(n),a=h.map(function(f){return $(f,!0)}),t=e.css(n,["height","padding"]);e.Transition.cancel(n),h.forEach(e.Transition.cancel),P(n),r(),h=h.concat(e.children(n).filter(function(f){return!e.includes(h,f)})),e.Promise.resolve().then(function(){e.fastdom.flush();var f=e.css(n,["height","padding"]),c=R(n,h,a),d=c[0],i=c[1];h.forEach(function(p,v){return i[v]&&e.css(p,i[v])}),e.css(n,e.assign({display:"block"},t)),requestAnimationFrame(function(){var p=h.map(function(v,m){return e.parent(v)===n&&e.Transition.start(v,d[m],o,"ease")}).concat(e.Transition.start(n,f,o,"ease"));e.Promise.all(p).then(function(){h.forEach(function(v,m){return e.parent(v)===n&&e.css(v,"display",d[m].opacity===0?"none":"")}),P(n)},e.noop).then(s)})})})})}function $(r,n){var o=e.css(r,"zIndex");return e.isVisible(r)?e.assign({display:"",opacity:n?e.css(r,"opacity"):"0",pointerEvents:"none",position:"absolute",zIndex:o==="auto"?e.index(r):o},x(r)):!1}function R(r,n,o){var s=n.map(function(a,t){return e.parent(a)&&t in o?o[t]?e.isVisible(a)?x(a):{opacity:0}:{opacity:e.isVisible(a)?1:0}:!1}),h=s.map(function(a,t){var f=e.parent(n[t])===r&&(o[t]||$(n[t]));if(!f)return!1;if(!a)delete f.opacity;else if(!("opacity"in a)){var c=f.opacity;c%1?a.opacity=1:delete f.opacity}return f});return[s,h]}function P(r){e.css(r.children,{height:"",left:"",opacity:"",pointerEvents:"",position:"",top:"",marginTop:"",marginLeft:"",transform:"",width:"",zIndex:""}),e.css(r,{height:"",display:"",padding:""})}function x(r){var n=e.offset(r),o=n.height,s=n.width,h=e.position(r),a=h.top,t=h.left,f=e.css(r,["marginTop","marginLeft"]),c=f.marginLeft,d=f.marginTop;return{top:a,left:t,height:o,width:s,marginLeft:c,marginTop:d,transform:""}}var H={props:{duration:Number,animation:Boolean},data:{duration:150,animation:"slide"},methods:{animate:function(r,n){var o=this;n===void 0&&(n=this.$el);var s=this.animation,h=s==="fade"?y:s==="delayed-fade"?function(){for(var a=[],t=arguments.length;t--;)a[t]=arguments[t];return y.apply(void 0,a.concat([40]))}:s?F:function(){return r(),e.Promise.resolve()};return h(r,n,this.duration).then(function(){return o.$update(n,"resize")},e.noop)}}},z={connected:function(){!e.hasClass(this.$el,this.$name)&&e.addClass(this.$el,this.$name)}},S={mixins:[z,H],props:{group:String,threshold:Number,clsItem:String,clsPlaceholder:String,clsDrag:String,clsDragState:String,clsBase:String,clsNoDrag:String,clsEmpty:String,clsCustom:String,handle:String},data:{group:!1,threshold:5,clsItem:"ykuk-sortable-item",clsPlaceholder:"ykuk-sortable-placeholder",clsDrag:"ykuk-sortable-drag",clsDragState:"ykuk-drag",clsBase:"ykuk-sortable",clsNoDrag:"ykuk-sortable-nodrag",clsEmpty:"ykuk-sortable-empty",clsCustom:"",handle:!1,pos:{}},created:function(){var r=this;["init","start","move","end"].forEach(function(n){var o=r[n];r[n]=function(s){e.assign(r.pos,e.getEventPos(s)),o(s)}})},events:{name:e.pointerDown,passive:!1,handler:"init"},computed:{target:function(){return(this.$el.tBodies||[this.$el])[0]},items:function(){return e.children(this.target)},isEmpty:{get:function(){return e.isEmpty(this.items)},watch:function(r){e.toggleClass(this.target,this.clsEmpty,r)},immediate:!0},handles:{get:function(r,n){var o=r.handle;return o?e.$$(o,n):this.items},watch:function(r,n){e.css(n,{touchAction:"",userSelect:""}),e.css(r,{touchAction:e.hasTouch?"none":"",userSelect:"none"})},immediate:!0}},update:{write:function(r){if(!(!this.drag||!e.parent(this.placeholder))){var n=this,o=n.pos,s=o.x,h=o.y,a=n.origin,t=a.offsetTop,f=a.offsetLeft,c=n.placeholder;e.css(this.drag,{top:h-t,left:s-f});var d=this.getSortable(document.elementFromPoint(s,h));if(!!d){var i=d.items;if(!i.some(e.Transition.inProgress)){var p=V(i,{x:s,y:h});if(!(i.length&&(!p||p===c))){var v=this.getSortable(c),m=q(d.target,p,c,s,h,d===v&&r.moved!==p);m!==!1&&(m&&c===m||(d!==v?(v.remove(c),r.moved=p):delete r.moved,d.insert(c,m),this.touched.add(d)))}}}}},events:["move"]},methods:{init:function(r){var n=r.target,o=r.button,s=r.defaultPrevented,h=this.items.filter(function(t){return e.within(n,t)}),a=h[0];!a||s||o>0||e.isInput(n)||e.within(n,"."+this.clsNoDrag)||this.handle&&!e.within(n,this.handle)||(r.preventDefault(),this.touched=new Set([this]),this.placeholder=a,this.origin=e.assign({target:n,index:e.index(a)},this.pos),e.on(document,e.pointerMove,this.move),e.on(document,e.pointerUp,this.end),this.threshold||this.start(r))},start:function(r){this.drag=M(this.$container,this.placeholder);var n=this.placeholder.getBoundingClientRect(),o=n.left,s=n.top;e.assign(this.origin,{offsetLeft:this.pos.x-o,offsetTop:this.pos.y-s}),e.addClass(this.drag,this.clsDrag,this.clsCustom),e.addClass(this.placeholder,this.clsPlaceholder),e.addClass(this.items,this.clsItem),e.addClass(document.documentElement,this.clsDragState),e.trigger(this.$el,"start",[this,this.placeholder]),N(this.pos),this.move(r)},move:function(r){this.drag?this.$emit("move"):(Math.abs(this.pos.x-this.origin.x)>this.threshold||Math.abs(this.pos.y-this.origin.y)>this.threshold)&&this.start(r)},end:function(){var r=this;if(e.off(document,e.pointerMove,this.move),e.off(document,e.pointerUp,this.end),e.off(window,"scroll",this.scroll),!!this.drag){A();var n=this.getSortable(this.placeholder);this===n?this.origin.index!==e.index(this.placeholder)&&e.trigger(this.$el,"moved",[this,this.placeholder]):(e.trigger(n.$el,"added",[n,this.placeholder]),e.trigger(this.$el,"removed",[this,this.placeholder])),e.trigger(this.$el,"stop",[this,this.placeholder]),e.remove(this.drag),this.drag=null,this.touched.forEach(function(o){var s=o.clsPlaceholder,h=o.clsItem;return r.touched.forEach(function(a){return e.removeClass(a.items,s,h)})}),this.touched=null,e.removeClass(document.documentElement,this.clsDragState)}},insert:function(r,n){var o=this;e.addClass(this.items,this.clsItem);var s=function(){return n?e.before(n,r):e.append(o.target,r)};this.animate(s)},remove:function(r){!e.within(r,this.target)||this.animate(function(){return e.remove(r)})},getSortable:function(r){do{var n=this.$getComponent(r,"sortable");if(n&&(n===this||this.group!==!1&&n.group===this.group))return n}while(r=e.parent(r))}}},I;function N(r){var n=Date.now();I=setInterval(function(){var o=r.x,s=r.y;s+=window.pageYOffset;var h=(Date.now()-n)*.3;n=Date.now(),e.scrollParents(document.elementFromPoint(o,r.y),/auto|scroll/).reverse().some(function(a){var t=a.scrollTop,f=a.scrollHeight,c=e.offset(e.getViewport(a)),d=c.top,i=c.bottom,p=c.height;if(d<s&&d+35>s)t-=h;else if(i>s&&i-35<s)t+=h;else return;if(t>0&&t<f-p)return e.scrollTop(a,t),!0})},15)}function A(){clearInterval(I)}function M(r,n){var o=e.append(r,n.outerHTML.replace(/(^<)(?:li|tr)|(?:li|tr)(\/>$)/g,"$1div$2"));return e.css(o,"margin","0","important"),e.css(o,e.assign({boxSizing:"border-box",width:n.offsetWidth,height:n.offsetHeight},e.css(n,["paddingLeft","paddingRight","paddingTop","paddingBottom"]))),e.height(o.firstElementChild,e.height(n.firstElementChild)),o}function V(r,n){return r[e.findIndex(r,function(o){return e.pointInRect(n,o.getBoundingClientRect())})]}function q(r,n,o,s,h,a){if(!!e.children(r).length){var t=n.getBoundingClientRect();if(!a)return W(r,o)||h<t.top+t.height/2?n:n.nextElementSibling;var f=o.getBoundingClientRect(),c=E([t.top,t.bottom],[f.top,f.bottom]),d=c?s:h,i=c?"width":"height",p=c?"left":"top",v=c?"right":"bottom",m=f[i]<t[i]?t[i]-f[i]:0;return f[p]<t[p]?m&&d<t[p]+m?!1:n.nextElementSibling:m&&d>t[v]-m?!1:n}}function W(r,n){var o=e.children(r).length===1;o&&e.append(r,n);var s=e.children(r),h=s.some(function(a,t){var f=a.getBoundingClientRect();return s.slice(t+1).some(function(c){var d=c.getBoundingClientRect();return!E([f.left,f.right],[d.left,d.right])})});return o&&e.remove(n),h}function E(r,n){return r[1]>n[0]&&n[1]>r[0]}return typeof window!="undefined"&&window.ykukUIkit&&window.ykukUIkit.component("sortable",S),S});
