function ws_ls_post_data(e,t){var a=ws_ls_config["ajax-url"];jQuery.post(a,e,function(a){var a=JSON.parse(a);t(e,a)})}function ws_ls_user_preference_callback(e,t){1==t?window.location.replace(ws_ls_config["current-url"]+"?user-preference-saved=true"):console.log("Error saving the user preferences")}function ws_ls_get_querystring_value(e){for(var t=window.location.search.substring(1),a=t.split("&"),s=0;s<a.length;s++){var r=a[s].split("=");if(r[0]==e)return r[1]}}$tabs_global=!1,jQuery(window).ready(function(e){function t(t,a){if(1==a){var r=e("#"+t["table-id"]).DataTable(),i=e("#"+t["table-row-id"]);r.row(i).remove().draw(),s()}else console.log("Error deleting entry :(",t,a)}function a(t,a){0!=a?("true"==ws_ls_config["us-date"]?e("#"+t["form-id"]+" .we-ls-datepicker").val(a["date-us"]):e("#"+t["form-id"]+" .we-ls-datepicker").val(a["date-uk"]),$weight_unit=e("#"+t["form-id"]).data("metric-unit"),"imperial-pounds"==$weight_unit&&e("#"+t["form-id"]+" #we-ls-weight-pounds").val(a.only_pounds),"imperial-both"==$weight_unit&&(e("#"+t["form-id"]+" #we-ls-weight-stones").val(a.stones),e("#"+t["form-id"]+" #we-ls-weight-pounds").val(a.pounds)),"metric"==$weight_unit&&e("#"+t["form-id"]+" #we-ls-weight-kg").val(a.kg),e("#"+t["form-id"]+" #we-ls-notes").val(a.notes),"true"==ws_ls_config["tabs-enabled"]&&$tabs_global.data("zozoTabs").first(),e(".ws-ls-main-weight-form input:visible:nth-child(3)").focus()):console.log("Error loading entry :(",t,a)}function s(){e(".ws-ls-notice-of-refresh").removeClass("ws-ls-hide")}"true"==ws_ls_config["advanced-tables-enabled"]&&("true"==ws_ls_config["us-date"]?e.fn.dataTable.moment("MM/DD/YYYY"):e.fn.dataTable.moment("DD/MM/YYYY"),e(".ws-ls-advanced-data-table").DataTable({responsive:!0,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]],columns:[null,{aDataSort:[4,0],aTargets:[1]},null,{bSortable:!1},{bSortable:!0,bSearchable:!1,bVisible:!1},{bSortable:!1,bSearchable:!1}]})),e(".ws-ls-edit-row").click(function(t){t.preventDefault(),$post_data={},$post_data.action="ws_ls_get_entry",$post_data.security=ws_ls_config["ajax-security-nonce"],$post_data["user-id"]=ws_ls_config["user-id"],$post_data["row-id"]=e(this).data("row-id"),$post_data["form-id"]=e(".ws-ls-main-weight-form").attr("id"),ws_ls_post_data($post_data,a)}),e(".ws-ls-delete-row").click(function(a){if(a.preventDefault(),confirm(ws_ls_config["confirmation-delete"])){var s=e(this).closest("tr"),r=e(this).closest("table");$post_data={},$post_data.action="ws_ls_delete_weight_entry",$post_data.security=ws_ls_config["ajax-security-nonce"],$post_data["user-id"]=ws_ls_config["user-id"],$post_data["table-row-id"]=s.attr("id"),$post_data["table-id"]=r.attr("id"),$post_data["row-id"]=e(this).data("row-id"),ws_ls_post_data($post_data,t)}})}),jQuery(document).ready(function(e){function t(t){$chart_type=e("#"+t).data("chart-type"),"undefined"==typeof $chart_type&&($chart_type="line");var a=e("#"+t).get(0).getContext("2d"),s=e("#"+t).parent().width();e("#"+t).attr("width",s-50),"line"==$chart_type?new Chart(a).Line(this[t+"_data"],this[t+"_options"]):"bar"==$chart_type&&($target_colour=e("#"+t).data("target-colour"),$target_weight=e("#"+t).data("target-weight"),Chart.types.Bar.extend({name:"BarOverlay",draw:function(e){Chart.types.Bar.prototype.draw.apply(this),a.beginPath(),a.lineWidth=2,a.strokeStyle=$target_colour,a.moveTo(35,this.scale.calculateY($target_weight)),a.lineTo(this.scale.calculateX(this.datasets[0].bars.length),this.scale.calculateY($target_weight)),a.stroke()}}),new Chart(a).BarOverlay(this[t+"_data"],this[t+"_options"]))}"true"==ws_ls_config["tabs-enabled"]&&($default_tab="tab1",$tabs_global=e("#ws-ls-tabs").zozoTabs({rounded:!1,multiline:!0,theme:"silver",size:"medium",responsive:!0,animation:{effects:"slideH",easing:"easeInOutCirc",type:"jquery"},defaultTab:$default_tab})),e(".ws-ls-chart").each(function(){$chart_id=e(this).attr("id"),t($chart_id)}),e(".we-ls-datepicker").each(function(){var t={changeMonth:!0,changeYear:!0,showButtonPanel:!0,dateFormat:ws_ls_config["date-format"]};e(this).datepicker(t)}),e(".we-ls-weight-form-validate").each(function(){$form_id=e(this).attr("id"),$target_form=e(this).data("is-target-form"),$weight_unit=e(this).data("metric-unit"),console.log("Adding form validation to: "+$form_id+". Target form? "+$target_form+". Weight Unit: "+$weight_unit),e("#"+$form_id).validate({errorClass:"ws-ls-invalid",validClass:"ws-ls-valid",errorContainer:"#"+$form_id+" .ws-ls-error-summary",errorLabelContainer:"#"+$form_id+" .ws-ls-error-summary ul",wrapper:"li",messages:{"we-ls-date":ws_ls_config["validation-we-ls-date"],"we-ls-weight-pounds":ws_ls_config["validation-we-ls-weight-pounds"],"we-ls-weight-kg":ws_ls_config["validation-we-ls-weight-kg"],"we-ls-weight-stones":ws_ls_config["validation-we-ls-weight-stones"]},submitHandler:function(e){e.submit()}}),$target_form||e("#"+$form_id+" .we-ls-datepicker").length&&("true"==ws_ls_config["us-date"]?e("#"+$form_id+" .we-ls-datepicker").rules("add",{required:!0,date:!0}):e("#"+$form_id+" .we-ls-datepicker").rules("add",{required:!0,dateITA:!0})),"imperial-pounds"==$weight_unit&&e("#"+$form_id+" #we-ls-weight-pounds").rules("add",{required:!0,number:!0,range:[0,5e3]}),"imperial-both"==$weight_unit&&(e("#"+$form_id+" #we-ls-weight-stones").rules("add",{required:!0,number:!0,range:[0,5e3]}),e("#"+$form_id+" #we-ls-weight-pounds").rules("add",{required:!0,number:!0,range:[0,14]})),"metric"==$weight_unit&&e("#"+$form_id+" #we-ls-weight-kg").rules("add",{required:!0,number:!0,range:[0,5e4]})}),"true"==ws_ls_config["is-pro"]&&(e(".ws-ls-user-delete-all").validate({errorClass:"ws-ls-invalid",validClass:"ws-ls-valid",errorContainer:".ws-ls-user-delete-all .ws-ls-error-summary",errorLabelContainer:".ws-ls-user-delete-all .ws-ls-error-summary ul",wrapper:"li",messages:{"ws-ls-delete-all":ws_ls_config["validation-we-ls-history"]},submitHandler:function(e){e.submit()}}),e(".ws-ls-user-pref-form").submit(function(t){t.preventDefault(),$post_data={},e(".ws-ls-user-pref-form select").each(function(){$post_data[e(this).attr("id")]=e(this).val()}),$post_data.action="ws_ls_save_preferences",$post_data.security=ws_ls_config["ajax-security-nonce"],$post_data["user-id"]=ws_ls_config["user-id"],ws_ls_post_data($post_data,ws_ls_user_preference_callback)})),e(".ws-ls-reload-page-if-clicked").click(function(e){e.preventDefault(),window.location.replace(ws_ls_config["current-url"])})});
